{% extends 'blog/_layouts/base.html' %}
{% load comments %}

{% block title %}
    {{ post.name }} | El Universo Maytok
{% endblock %}
{% block content %}
    <div class="page__content" data-page-title="{{ post.name }} | El Universo Maytok">
        {% include 'blog/_includes/contact.html' %}

        <div class="page-post">
            <header class="post__header header--single">
                <div class="wrap">
                    <h1 class="post__title">{{ post.name }}</h1>
                    <time class="post__date label"
                          data-utc="{{ post.created_at | date:"Y-m-d H:i" }}">
                        {{ post.created_at | date:"M d, Y" }}
                    </time>
                </div>
            </header>

            <section class="post-full">
                <div class="wrap">
                    <article class="post__content ">
                        {{ post.body|safe }}
                    </article>
                    <div class="post__more grid">
                        {% if prev_post != None %}
                            <a class="prev-post subtitle"
                               href="{% url 'blog_post' pk=prev_post.pk slug=prev_post.slug %}">
                                {{ prev_post.name }}
                            </a>
                        {% endif %}
                        {% if next_post != None %}
                            <a class="next-post subtitle"
                               href="{% url 'blog_post' pk=next_post.pk slug=next_post.slug %}">
                                {{ next_post.name }}
                            </a>
                        {% endif %}
                    </div>
                    <section id="comments-wrapper">
                        <a id="comments" name="comments"></a>

                        <div id="form-wrapper">
                            {% if user.is_authenticated %}
                                <header>Comenta</header>
                                {% render_comment_form for post %}
                            {% else %}
                                <h5 class="comments-title">Debes estar registrado para comentar</h5>
                            {% endif %}
                        </div>


                        {% get_comment_list for post as comment_list %}
                        <ol id="comments-lists">
                            {% for comment in comment_list %}
                                <li id="c{{ comment.id }}">
                                    <figure>
                                        <img src="{{ comment.user.get_avatar }}" alt="author" class="img-avatar">
                                        <img src="/static/core/img/{{ comment.user.get_rank_display }}.png" alt=""
                                             class="img-rank">
                                    </figure>
                                    <div class="comment-body">
                                        <div class="comment-meta">
                                            <div class="comment-author">{{ comment.user.rank_name }} {{ comment.user.get_full_name }}</div>
                                            <p>{{ comment.comment }}</p>
                                            <div class="reply-wrapper">
                                                <span>
                                                    <i class="icon-clock">{% include 'includes/clock.svg' %}</i>{{ comment.submit_date | date:"M d, Y" }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ol>
                    </section>
                </div>
            </section>
        </div>
    </div>
{% endblock %}
